!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.PaintLine=i():t.PaintLine=i()}(self,(function(){return(()=>{"use strict";var t={d:(i,n)=>{for(var h in n)t.o(n,h)&&!t.o(i,h)&&Object.defineProperty(i,h,{enumerable:!0,get:n[h]})},o:(t,i)=>Object.prototype.hasOwnProperty.call(t,i)},i={};t.d(i,{default:()=>P});var n=function(t){console.error("[Draw Warn]: "+t)};function h(t){this._cvs=document.getElementById(t.ele);var{clientWidth:i,clientHeight:n}=t.cvsBody;this.lineNum=t.lineNum||1,this.limitPoint=t.limitPoint||5,this.lineClosed=t.lineClosed||!1,this._cvs.width=i,this._cvs.height=n,this.clientWidth=i,this.clientHeight=n,this._direction=t.direction||!1,this.arrowLength=t.arrowLength||40,this.angleLength=t.angleLength||16,this.currIndex=1,this._ctx=this._cvs.getContext("2d"),this._init(t)}function e(t,i,n){var h=t.getBoundingClientRect();return{x:i-h.left-7,y:n-h.top-5}}function o(){return this.getPoint().length&&this._onPaint}function s(t){var{x:i,y:n}=e(this._cvs,t.pageX,t.pageY),h=this.getPoint();if(h.length===this.limitPoint-1){if(this.lineClosed){let[t,e]=h[0];x.call(this,t,e,i,n)}g.call(this,i,n),h.push([i,n]),this.fillPolygon&&u.call(this,h,h.length),this.lineNum>this.currIndex?this.currIndex++:(this.currIndex=1,this._onPaint=!1)}else h.length<this.limitPoint-1&&(g.call(this,i,n),h.push([i,n]))}function l(t){t.pointList&&t.pointList.length?(this._onPaint=!1,this.paintOld()):this._onPaint=!0}function a(t){var i=t.lineNum?t.lineNum:1,n=t.pointList&&t.pointList.length;for(let h=0;h<i;h++)this[`_point${h+1}`]=n?t.pointList[h]:[]}function r(t,i){return Math.floor(i+(t-i)/2)}function c(t,i,n,h){for(let e=1;e<n;e++){let[n,o]=h[e];if("line"===t){1===e&&this._direction&&_.call(this,n,o,i);let[t,s]=h[e-1];i.call(this,t,s,n,o)}else i.call(this,n,o)}if(this.lineClosed&&this.lineNum>=2&&"line"===t&&n===this.limitPoint){let[t,e]=h[0],[o,s]=h[n-1];i.call(this,o,s,t,e)}"arc"===t&&h.length&&i.call(this,h[0][0],h[0][1])}function u(t,i){this._ctx.beginPath();var[n,h]=t[0];this._ctx.strokeStyle="#f00",this._ctx.lineWidth=4,this._ctx.moveTo(n,h);for(let n=1;n<i;n++){let[i,h]=t[n];this._ctx.lineTo(i,h)}this._ctx.lineTo(n,h),this._ctx.fillStyle="rgba(230, 0, 0, 0.3)",this._ctx.stroke(),this._ctx.fill();for(let n=0;n<i;n++){let[i,h]=t[n];g.call(this,i,h)}}function d(t,i,n){let h=this[`_point${n}`];var e=h.length;this.fillPolygon&&h.length===this.limitPoint?u.call(this,h,e):c.call(this,t,i,e,h)}function f(t){return!t&&n(`${t} is not defined`),t}function M(t){this.fillPolygon=this.limitPoint>=3&&t}function p(t,i,n,h,e,o,s){var l,a,r,c,u=this.angleLength,d=Math.abs(n);if(n>45&&n<=90){var f=Math.abs((d-45)*Math.PI/180),M=Math.abs(u*Math.cos(f)),p=Math.abs(u*Math.sin(f));h>e&&o>s?(l=Math.round(t-M),a=Math.round(i-p),r=Math.round(t-p),c=Math.round(i+M)):(l=Math.round(t+M),a=Math.round(i+p),r=Math.round(t+p),c=Math.round(i-M))}else if(n<=-45&&n>=-90){f=Math.abs((d-45)*Math.PI/180);var _=Math.abs(u*Math.cos(f)),g=Math.abs(u*Math.sin(f));h<e&&o>s?(l=Math.round(t-g),a=Math.round(i-_),r=Math.round(t-_),c=Math.round(i+g)):(l=Math.round(t+g),a=Math.round(i+_),r=Math.round(t+_),c=Math.round(i-g))}else if(n>-45&&n<=0){f=Math.abs((45-d)*Math.PI/180);var x=Math.abs(u*Math.cos(f)),P=Math.abs(u*Math.sin(f));h<e&&o>s?(l=Math.round(t+P),a=Math.round(i-x),r=Math.round(t-x),c=Math.round(i-P)):(l=Math.round(t-P),a=Math.round(i+x),r=Math.round(t+x),c=Math.round(i+P))}else if(n>0&&n<=45){f=Math.abs((45-d)*Math.PI/180);var v=Math.abs(u*Math.cos(f)),y=Math.abs(u*Math.sin(f));h<e&&o<s?(l=Math.round(t+v),a=Math.round(i-y),r=Math.round(t-y),c=Math.round(i-v)):(l=Math.round(t-v),a=Math.round(i+y),r=Math.round(t+y),c=Math.round(i+v))}this._ctx.beginPath(),this._ctx.moveTo(t,i),this._ctx.lineTo(l,a),this._ctx.lineTo(r,c),this._ctx.closePath(),this._ctx.fillStyle="#f00",this._ctx.fill()}function _(t,i,n){var h,e,[o,s]=this[`_point${this.currIndex}`][0],l=Math.abs(r(t,o)),a=Math.abs(r(i,s)),c=this.arrowLength,{cx:u,cy:d,A:f}=function(t,i,n,h,e){var o,s,l,a,r=(l=(s={x:n,y:h}).x-(o={x:t,y:i}).x,a=s.y-o.y,360*Math.atan(a/l)/(2*Math.PI)),c=Math.abs(r*Math.PI/180),u=Math.round(e*Math.cos(c));return{cx:Math.round(e*Math.sin(c)),cy:u,A:r}}(o,s,t,i,c);o<t&&s>i?(h=l-u,e=a-d):o<t&&s<i?(h=l+u,e=a-d):o>t&&s<i?(h=l+u,e=a+d):(h=l-u,e=a+d),p.call(this,h,e,f,t,o,i,s),n.call(this,h,e,l,a)}function g(t,i){this._ctx.beginPath(),this._ctx.arc(t,i,5,0,2*Math.PI),this._ctx.fillStyle="#f00",this._ctx.fill()}function x(t,i,n,h){this._ctx.beginPath(),this._ctx.moveTo(t,i),this._ctx.lineTo(n,h),this._ctx.strokeStyle="#f00",this._ctx.lineWidth=4,this._ctx.stroke()}h.prototype.getPoint=function(){return this[`_point${this.currIndex}`]},h.prototype.getPointList=function(){var t=[],i=this.lineNum?this.lineNum:1;for(let n=0;n<i;n++)t.push(this[`_point${n+1}`]);return t},h.prototype.restartPaint=function(t){var i,h;i="limitPoint",h=t,"[object Object]"!==toString.call(h)&&n("选项"+i+"的值无效：必须是个对象"),this.limitPoint=f(t.limitPoint),this.lineNum=f(t.lineNum),this.fillPolygon=t.fillPolygon,this.lineClosed=t.lineClosed,this._direction=t.direction||!1,this.clear(),this._onPaint=!0,this.currIndex=1},h.prototype.clear=function(){this.clearCvs(),this.loopLineNum((function(t){this[`_point${t}`]=[]})),this._onPaint=!1},h.prototype.clearCvs=function(){this._ctx.clearRect(0,0,this.clientWidth,this.clientHeight)},h.prototype.loopLineNum=function(t){for(let i=0;i<this.lineNum;i++)t.call(this,i+1)},h.prototype.iteratePoint=function(t,i){this.loopLineNum((function(n){d.call(this,t,i,n)}))},h.prototype._init=function(t){var i=this;a.call(this,t),M.call(this,t.fillPolygon),l.call(this,t),this._cvs.addEventListener("mouseup",(function(t){i._onPaint&&s.call(i,t)})),this._cvs.addEventListener("mousemove",(function(t){o.call(i)&&i.draw(t)}))},h.prototype.draw=function(t){var i=this.getPoint();this.clearCvs();var{x:n,y:h}=e(this._cvs,t.pageX,t.pageY),[o,s]=i[i.length-1];x.call(this,o,s,n,h),1===i.length&&this._direction&&_.call(this,n,h,x),this.paintOld()},h.prototype.paintOld=function(){this.iteratePoint("line",x),this.iteratePoint("arc",g)};const P=h;return i.default})()}));